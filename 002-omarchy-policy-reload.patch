From 762b4443a3f8ffeb02037eb063e8f5f03f771df1 Mon Sep 17 00:00:00 2001
From: helmut januschka <helmut@januschka.com>
Date: Fri, 31 Oct 2025 07:18:06 +0000
Subject: [PATCH] Applied patch 002 - policy reload logging

---
 chrome/browser/themes/theme_service.cc | 19 +++++++++++++++++--
 1 file changed, 17 insertions(+), 2 deletions(-)

diff --git a/chrome/browser/themes/theme_service.cc b/chrome/browser/themes/theme_service.cc
index 46edaa8219..02ea3e364e 100644
--- a/chrome/browser/themes/theme_service.cc
+++ b/chrome/browser/themes/theme_service.cc
@@ -16,6 +16,7 @@
 #include "base/files/file_util.h"
 #include "base/functional/bind.h"
 #include "base/location.h"
+#include "base/logging.h"
 #include "base/memory/raw_ptr.h"
 #include "base/memory/ref_counted_memory.h"
 #include "base/metrics/histogram_macros.h"
@@ -25,10 +26,12 @@
 #include "base/strings/string_number_conversions.h"
 #include "base/strings/string_split.h"
 #include "base/strings/string_util.h"
+#include "base/strings/stringprintf.h"
 #include "base/strings/utf_string_conversions.h"
 #include "base/task/sequenced_task_runner.h"
 #include "base/task/single_thread_task_runner.h"
 #include "base/task/thread_pool.h"
+#include "base/time/time.h"
 #include "base/trace_event/trace_event.h"
 #include "build/build_config.h"
 #include "chrome/browser/extensions/extension_service.h"
@@ -579,8 +582,20 @@ SkColor ThemeService::GetAutogeneratedThemeColor() const {
 }
 
 void ThemeService::BuildAutogeneratedPolicyTheme() {
-  BuildAutogeneratedThemeFromColor(GetPolicyThemeColor(),
-                                   /*store_user_prefs*/ false);
+  SkColor policy_color = GetPolicyThemeColor();
+
+  if (VLOG_IS_ON(1)) {
+    base::Time::Exploded now;
+    base::Time::Now().LocalExplode(&now);
+    VLOG(1) << "[THEME_TIMING] Policy theme applied at: "
+            << base::StringPrintf("%02d%02d/%02d%02d%02d.%03d", now.month,
+                                  now.day_of_month, now.hour, now.minute,
+                                  now.second, now.millisecond)
+            << " color=#"
+            << base::StringPrintf("%06X", policy_color & 0xFFFFFF);
+  }
+
+  BuildAutogeneratedThemeFromColor(policy_color, /*store_user_prefs*/ false);
 }
 
 SkColor ThemeService::GetPolicyThemeColor() const {
-- 
2.51.0

